// ÊÑõÊÉÖÈ°ßÂïèËÅäÂ§©Ê©üÂô®‰∫∫È°ûÂà•
class LoveAdvisorChatBot {
    constructor() {
        // ‚ö†Ô∏è ÈáçË¶ÅÔºöË´ãÊõøÊèõÁÇ∫ÊÇ®ÁöÑ n8n webhook URL
        this.webhookUrl = 'https://joannayayaya.app.n8n.cloud/webhook/love-chat';
        
        // ÂàùÂßãÂåñ session ID
        this.sessionId = this.getOrCreateSessionId();
        
        // ÂâµÂª∫ËÅäÂ§©Ê©üÂô®‰∫∫ UI
        this.createChatBotUI();
        
        // DOM ÂÖÉÁ¥†
        this.chatbotToggle = document.getElementById('loveAdvisorToggle');
        this.chatbotPanel = document.getElementById('loveAdvisorPanel');
        this.chatbotClose = document.getElementById('loveAdvisorClose');
        this.messagesContainer = document.getElementById('loveMessages');
        this.messageInput = document.getElementById('loveMessageInput');
        this.sendButton = document.getElementById('loveSendButton');
        this.typingIndicator = document.getElementById('loveTypingIndicator');
        this.notificationBadge = document.getElementById('loveNotificationBadge');
        
        // Á∂ÅÂÆö‰∫ã‰ª∂
        this.bindEvents();
        
        // ËºâÂÖ•Â∞çË©±Ê≠∑Âè≤
        this.loadChatHistory();
        
        console.log('ÊÑõÊÉÖÈ°ßÂïèËÅäÂ§©Ê©üÂô®‰∫∫ÂàùÂßãÂåñÂÆåÊàêÔºåSession ID:', this.sessionId);
    }
    
    createChatBotUI() {
        // ÂâµÂª∫Êµ™Êº´ÁöÑ CSS Ê®£Âºè
        const style = document.createElement('style');
        style.textContent = `
            .love-advisor-widget {
                position: fixed;
                bottom: 20px;
                right: 20px;
                z-index: 1000;
            }

            .love-advisor-toggle {
                width: 70px;
                height: 70px;
                background: linear-gradient(135deg, #ff6b9d 0%, #c44569 50%, #f8b500 100%);
                border: none;
                border-radius: 50%;
                cursor: pointer;
                box-shadow: 0 8px 25px rgba(255, 107, 157, 0.4);
                transition: all 0.3s ease;
                color: white;
                font-size: 28px;
                display: flex;
                align-items: center;
                justify-content: center;
                position: relative;
                animation: heartbeat 2s infinite;
            }

            @keyframes heartbeat {
                0%, 50%, 100% { transform: scale(1); }
                25%, 75% { transform: scale(1.05); }
            }

            .love-advisor-toggle:hover {
                transform: scale(1.15);
                box-shadow: 0 10px 30px rgba(255, 107, 157, 0.6);
                animation-play-state: paused;
            }

            .love-advisor-panel {
                position: absolute;
                bottom: 90px;
                right: 0;
                width: 380px;
                height: 550px;
                background: linear-gradient(135deg, #ffeef8 0%, #fff0f3 100%);
                border-radius: 20px;
                box-shadow: 0 15px 40px rgba(0,0,0,0.15);
                display: none;
                flex-direction: column;
                overflow: hidden;
                border: 2px solid rgba(255, 107, 157, 0.2);
                backdrop-filter: blur(10px);
            }

            .love-advisor-panel.active {
                display: flex;
                animation: romanticSlideUp 0.4s ease-out;
            }

            @keyframes romanticSlideUp {
                from {
                    opacity: 0;
                    transform: translateY(30px) scale(0.95);
                }
                to {
                    opacity: 1;
                    transform: translateY(0) scale(1);
                }
            }

            .love-advisor-header {
                background: linear-gradient(135deg, #ff6b9d 0%, #c44569 50%, #f8b500 100%);
                color: white;
                padding: 20px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                position: relative;
                overflow: hidden;
            }

            .love-advisor-header::before {
                content: '';
                position: absolute;
                top: -50%;
                left: -50%;
                width: 200%;
                height: 200%;
                background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="20" fill="rgba(255,255,255,0.1)">üíñ</text></svg>') repeat;
                animation: floatingHearts 20s linear infinite;
            }

            @keyframes floatingHearts {
                0% { transform: translate(0, 0); }
                100% { transform: translate(-50px, -50px); }
            }

            .love-advisor-title {
                font-size: 18px;
                font-weight: bold;
                z-index: 1;
                position: relative;
            }

            .love-advisor-close {
                background: none;
                border: none;
                color: white;
                font-size: 20px;
                cursor: pointer;
                width: 35px;
                height: 35px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: all 0.3s ease;
                z-index: 1;
                position: relative;
            }

            .love-advisor-close:hover {
                background: rgba(255,255,255,0.2);
                transform: rotate(90deg);
            }

            .love-messages {
                flex: 1;
                overflow-y: auto;
                padding: 20px;
                display: flex;
                flex-direction: column;
                gap: 15px;
                background: linear-gradient(135deg, #ffeef8 0%, #fff0f3 100%);
            }

            .love-message {
                max-width: 85%;
                padding: 12px 16px;
                border-radius: 20px;
                line-height: 1.5;
                word-wrap: break-word;
                font-size: 14px;
                animation: loveMessageSlide 0.5s ease-out;
                position: relative;
            }

            @keyframes loveMessageSlide {
                from {
                    opacity: 0;
                    transform: translateY(15px) scale(0.95);
                }
                to {
                    opacity: 1;
                    transform: translateY(0) scale(1);
                }
            }

            .love-message.user {
                background: linear-gradient(135deg, #ff6b9d, #c44569);
                color: white;
                align-self: flex-end;
                border-bottom-right-radius: 6px;
                box-shadow: 0 4px 15px rgba(255, 107, 157, 0.3);
            }

            .love-message.advisor {
                background: white;
                color: #2d3436;
                align-self: flex-start;
                border-bottom-left-radius: 6px;
                border: 1px solid rgba(255, 107, 157, 0.2);
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }

            .love-message.system {
                background: linear-gradient(135deg, #fd79a8, #fdcb6e);
                color: white;
                align-self: center;
                font-size: 13px;
                max-width: 90%;
                text-align: center;
                box-shadow: 0 2px 10px rgba(253, 121, 168, 0.3);
            }

            .love-message.error-message {
                background: linear-gradient(135deg, #e17055, #d63031);
                color: white;
                align-self: center;
                font-size: 13px;
                max-width: 90%;
                text-align: center;
            }

            .love-typing-indicator {
                display: none;
                align-self: flex-start;
                padding: 12px 16px;
                background: white;
                border-radius: 20px;
                border-bottom-left-radius: 6px;
                border: 1px solid rgba(255, 107, 157, 0.2);
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }

            .love-typing-dots {
                display: flex;
                gap: 5px;
            }

            .love-typing-dot {
                width: 8px;
                height: 8px;
                background: linear-gradient(135deg, #ff6b9d, #c44569);
                border-radius: 50%;
                animation: loveTyping 1.6s infinite;
            }

            .love-typing-dot:nth-child(2) {
                animation-delay: 0.2s;
            }

            .love-typing-dot:nth-child(3) {
                animation-delay: 0.4s;
            }

            @keyframes loveTyping {
                0%, 60%, 100% {
                    transform: scale(1);
                    opacity: 0.6;
                }
                30% {
                    transform: scale(1.3);
                    opacity: 1;
                }
            }

            .love-input-container {
                padding: 20px;
                border-top: 1px solid rgba(255, 107, 157, 0.2);
                display: flex;
                gap: 10px;
                background: white;
                border-bottom-left-radius: 20px;
                border-bottom-right-radius: 20px;
            }

            .love-input-field {
                flex: 1;
                padding: 12px 16px;
                border: 2px solid rgba(255, 107, 157, 0.3);
                border-radius: 25px;
                outline: none;
                font-size: 14px;
                transition: all 0.3s ease;
                background: rgba(255, 238, 248, 0.5);
            }

            .love-input-field:focus {
                border-color: #ff6b9d;
                background: white;
                box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.1);
            }

            .love-input-field::placeholder {
                color: rgba(255, 107, 157, 0.6);
            }

            .love-send-button {
                padding: 12px 18px;
                background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%);
                color: white;
                border: none;
                border-radius: 25px;
                cursor: pointer;
                font-size: 14px;
                font-weight: bold;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 6px;
                min-width: 80px;
                justify-content: center;
            }

            .love-send-button:hover:not(:disabled) {
                transform: scale(1.05);
                box-shadow: 0 5px 20px rgba(255, 107, 157, 0.4);
            }

            .love-send-button:disabled {
                opacity: 0.5;
                cursor: not-allowed;
                transform: none;
            }

            .love-notification-badge {
                position: absolute;
                top: -8px;
                right: -8px;
                width: 24px;
                height: 24px;
                background: linear-gradient(135deg, #e84393, #d63031);
                color: white;
                border-radius: 50%;
                font-size: 12px;
                display: none;
                align-items: center;
                justify-content: center;
                animation: lovePulse 2s infinite;
                font-weight: bold;
                border: 2px solid white;
            }

            @keyframes lovePulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.2); }
                100% { transform: scale(1); }
            }

            /* ÈüøÊáâÂºèË®≠Ë®à */
            @media (max-width: 768px) {
                .love-advisor-panel {
                    width: 350px;
                    height: 500px;
                    bottom: 80px;
                }
            }

            @media (max-width: 480px) {
                .love-advisor-widget {
                    bottom: 15px;
                    right: 15px;
                }
                
                .love-advisor-toggle {
                    width: 60px;
                    height: 60px;
                    font-size: 24px;
                }
                
                .love-advisor-panel {
                    width: calc(100vw - 30px);
                    height: 75vh;
                    bottom: 85px;
                    right: -15px;
                }
            }

            .love-messages::-webkit-scrollbar {
                width: 6px;
            }

            .love-messages::-webkit-scrollbar-track {
                background: rgba(255, 107, 157, 0.1);
                border-radius: 3px;
            }

            .love-messages::-webkit-scrollbar-thumb {
                background: linear-gradient(135deg, #ff6b9d, #c44569);
                border-radius: 3px;
            }

            .love-messages::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(135deg, #e84393, #a29bfe);
            }
        `;
        document.head.appendChild(style);
        
        // ÂâµÂª∫ÊÑõÊÉÖÈ°ßÂïèËÅäÂ§©Ê©üÂô®‰∫∫ HTML
        const chatbotHTML = `
            <div class="love-advisor-widget" id="loveAdvisorWidget">
                <button class="love-advisor-toggle" id="loveAdvisorToggle">
                    üíï
                    <div class="love-notification-badge" id="loveNotificationBadge">üíå</div>
                </button>
                
                <div class="love-advisor-panel" id="loveAdvisorPanel">
                    <div class="love-advisor-header">
                        <div class="love-advisor-title">üíñ ÊÑõÊÉÖÈ°ßÂïèÂ∞èÁ¥ÖÂ®ò</div>
                        <button class="love-advisor-close" id="loveAdvisorClose">
                            ‚úï
                        </button>
                    </div>
                    
                    <div class="love-messages" id="loveMessages">
                        <div class="love-message system">
                            üíï Ê≠°Ëøé‰æÜÂà∞ÊÑõÊÉÖÈ°ßÂïèÔºÅÊàëÊòØ‰Ω†ÁöÑÂ∞àÂ±¨Â∞èÁ¥ÖÂ®òÔºåÁÑ°Ë´ñÊòØÊàÄÊÑõÂõ∞Êìæ„ÄÅÊÑüÊÉÖÂïèÈ°åÔºåÈÇÑÊòØÊÉ≥Ë¶ÅËÑ´ÂñÆÁßòË®£ÔºåÊàëÈÉΩËÉΩÂπ´‰Ω†Ëß£Á≠îÔºÅËÆìÊàëÂÄë‰∏ÄËµ∑ÊâæÂà∞‰Ω†ÁöÑÁúüÊÑõÂêßÔΩû üíï
                        </div>
                    </div>
                    
                    <div class="love-typing-indicator" id="loveTypingIndicator">
                        <div class="love-typing-dots">
                            <div class="love-typing-dot"></div>
                            <div class="love-typing-dot"></div>
                            <div class="love-typing-dot"></div>
                        </div>
                    </div>
                    
                    <div class="love-input-container">
                        <input 
                            type="text" 
                            class="love-input-field" 
                            id="loveMessageInput" 
                            placeholder="ÂëäË®¥Êàë‰Ω†ÁöÑÊÑõÊÉÖÁÖ©ÊÉ±Âêß... üí≠"
                            maxlength="500"
                        >
                        <button class="love-send-button" id="loveSendButton" disabled>
                            ÁôºÈÄÅ üíå
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        // ÊèíÂÖ•Âà∞ body Êú´Â∞æ
        document.body.insertAdjacentHTML('beforeend', chatbotHTML);
    }
    
    getOrCreateSessionId() {
        let sessionId = localStorage.getItem('love_advisor_session_id');
        if (!sessionId) {
            sessionId = 'love_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('love_advisor_session_id', sessionId);
        }
        return sessionId;
    }
    
    bindEvents() {
        // ËÅäÂ§©Ê©üÂô®‰∫∫ÈñãÈóú
        this.chatbotToggle.addEventListener('click', () => {
            this.toggleChatbot();
        });
        
        this.chatbotClose.addEventListener('click', () => {
            this.closeChatbot();
        });
        
        // ÁôºÈÄÅÊåâÈàïÈªûÊìä‰∫ã‰ª∂
        this.sendButton.addEventListener('click', () => {
            this.sendMessage();
        });
        
        // Ëº∏ÂÖ•Ê°ÜÊåâÈçµ‰∫ã‰ª∂
        this.messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                this.sendMessage();
            }
        });
        
        // Ëº∏ÂÖ•Ê°ÜËº∏ÂÖ•‰∫ã‰ª∂
        this.messageInput.addEventListener('input', () => {
            this.sendButton.disabled = this.messageInput.value.trim() === '';
        });
        
        // ÈªûÊìäÂ§ñÈÉ®ÈóúÈñâËÅäÂ§©Ê©üÂô®‰∫∫
        document.addEventListener('click', (e) => {
            if (!this.chatbotToggle.contains(e.target) && 
                !this.chatbotPanel.contains(e.target) && 
                this.chatbotPanel.classList.contains('active')) {
                this.closeChatbot();
            }
        });
    }
    
    toggleChatbot() {
        if (this.chatbotPanel.classList.contains('active')) {
            this.closeChatbot();
        } else {
            this.openChatbot();
        }
    }
    
    openChatbot() {
        this.chatbotPanel.classList.add('active');
        this.messageInput.focus();
        this.hideNotification();
        this.scrollToBottom();
    }
    
    closeChatbot() {
        this.chatbotPanel.classList.remove('active');
    }
    
    showNotification() {
        this.notificationBadge.style.display = 'flex';
    }
    
    hideNotification() {
        this.notificationBadge.style.display = 'none';
    }
    
    async sendMessage() {
        const message = this.messageInput.value.trim();
        if (!message) return;
        
        // È°ØÁ§∫Áî®Êà∂Ë®äÊÅØ
        this.addMessage(message, 'user');
        
        // Ê∏ÖÁ©∫Ëº∏ÂÖ•Ê°Ü‰∏¶Á¶ÅÁî®ÁôºÈÄÅÊåâÈàï
        this.messageInput.value = '';
        this.sendButton.disabled = true;
        
        // È°ØÁ§∫ÊâìÂ≠óÊåáÁ§∫Âô®
        this.showTypingIndicator();
        
        try {
            // ÁôºÈÄÅË´ãÊ±ÇÂà∞ n8n webhook
            const response = await fetch(this.webhookUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    message: message,
                    sessionId: this.sessionId,
                    timestamp: new Date().toISOString(),
                    type: 'love_advice' // Ê®ôË®òÈÄôÊòØÊÑõÊÉÖÂª∫Ë≠∞Ë´ãÊ±Ç
                })
            });
            
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const data = await response.json();
            
            if (data.success && data.message) {
                this.addMessage(data.message, 'advisor');
                
                // ÂÑ≤Â≠òÂ∞çË©±Âà∞Êú¨Âú∞
                this.saveChatToLocal(message, data.message);
                
                // Â¶ÇÊûúËÅäÂ§©Ê©üÂô®‰∫∫Â∑≤ÈóúÈñâÔºåÈ°ØÁ§∫ÈÄöÁü•
                if (!this.chatbotPanel.classList.contains('active')) {
                    this.showNotification();
                }
            } else {
                throw new Error('ÂõûÊáâÊ†ºÂºèÈåØË™§');
            }
            
        } catch (error) {
            console.error('ÁôºÈÄÅË®äÊÅØÊôÇÁôºÁîüÈåØË™§:', error);
            this.addMessage('üíî Êä±Ê≠âË¶™ÊÑõÁöÑÔºåÂ∞èÁ¥ÖÂ®òÊö´ÊôÇÊúâÈªûÂøôÔºåË´ãÁ®çÂæåÂÜç‰æÜÊâæÊàëËÅäËÅäÊÑõÊÉÖË©±È°åÂêßÔºÅ', 'error-message');
        } finally {
            // Èö±ËóèÊâìÂ≠óÊåáÁ§∫Âô®
            this.hideTypingIndicator();
        }
    }
    
    addMessage(content, type) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `love-message ${type}`;
        messageDiv.textContent = content;
        
        this.messagesContainer.appendChild(messageDiv);
        this.scrollToBottom();
    }
    
    showTypingIndicator() {
        this.typingIndicator.style.display = 'block';
        this.scrollToBottom();
    }
    
    hideTypingIndicator() {
        this.typingIndicator.style.display = 'none';
    }
    
    scrollToBottom() {
        setTimeout(() => {
            this.messagesContainer.scrollTop = this.messagesContainer.scrollHeight;
        }, 100);
    }
    
    saveChatToLocal(userMessage, advisorMessage) {
        const chatHistory = JSON.parse(localStorage.getItem('love_advisor_history') || '[]');
        
        chatHistory.push({
            timestamp: new Date().toISOString(),
            sessionId: this.sessionId,
            userMessage: userMessage,
            advisorMessage: advisorMessage
        });
        
        // ÈôêÂà∂Ê≠∑Âè≤Ë®òÈåÑÊï∏ÈáèÔºàÊúÄÂ§ö‰øùÂ≠ò 100 Ê¢ùÊÑõÊÉÖÂ∞çË©±Ôºâ
        if (chatHistory.length > 100) {
            chatHistory.splice(0, chatHistory.length - 100);
        }
        
        localStorage.setItem('love_advisor_history', JSON.stringify(chatHistory));
    }
    
    loadChatHistory() {
        const chatHistory = JSON.parse(localStorage.getItem('love_advisor_history') || '[]');
        const currentSessionHistory = chatHistory.filter(chat => chat.sessionId === this.sessionId);
        
        // Âè™ËºâÂÖ•ÊúÄËøëÁöÑ 10 Ê¢ùÊÑõÊÉÖÂ∞çË©±
        const recentHistory = currentSessionHistory.slice(-10);
        
        recentHistory.forEach(chat => {
            this.addMessage(chat.userMessage, 'user');
            this.addMessage(chat.advisorMessage, 'advisor');
        });
        
        if (recentHistory.length === 0) {
            // Â¶ÇÊûúÊ≤íÊúâÊ≠∑Âè≤Ë®òÈåÑÔºåÈ°ØÁ§∫Ê∫´È¶®Ê≠°ËøéË®äÊÅØ
            setTimeout(() => {
                const welcomeMessages = [
                    'üíï Âó®ÔΩûÊàëÊòØ‰Ω†ÁöÑÂ∞àÂ±¨ÊÑõÊÉÖÈ°ßÂïèÔºÅÊúâ‰ªÄÈ∫ºÊÑüÊÉÖÂïèÈ°åÊÉ≥Ë¶ÅË∑üÊàëËÅäËÅäÂóéÔºü',
                    'üíñ ‰∏çÁÆ°ÊòØÊöóÊàÄ„ÄÅÂëäÁôΩ„ÄÅÂàÜÊâãÈÇÑÊòØÊåΩÂõûÔºåÊàëÈÉΩËÉΩÁµ¶‰Ω†ÊúÄË≤ºÂøÉÁöÑÂª∫Ë≠∞ÔºÅ',
                    'üåπ ÈÇÑÊòØÊÉ≥Ë¶ÅÂ≠∏Áøí‰∏Ä‰∫õÁ¥ÑÊúÉÊäÄÂ∑ßÂíåÊàÄÊÑõÂøÉÁêÜÂ≠∏Âë¢ÔºüÂø´ÂëäË®¥ÊàëÂêßÔºÅ'
                ];
                
                welcomeMessages.forEach((msg, index) => {
                    setTimeout(() => {
                        this.addMessage(msg, 'advisor');
                    }, (index + 1) * 1500);
                });
            }, 1000);
        }
    }
    
    // Ê∏ÖÈô§ÊÑõÊÉÖÂ∞çË©±Ê≠∑Âè≤ÁöÑÊñπÊ≥ïÔºàÂèØ‰ª•Âú®ÊéßÂà∂Âè∞Ë™øÁî®Ôºâ
    clearHistory() {
        localStorage.removeItem('love_advisor_history');
        localStorage.removeItem('love_advisor_session_id');
        location.reload();
    }
    
    // Áç≤ÂæóÊÑõÊÉÖÂª∫Ë≠∞ÔºàÈ°çÂ§ñÂäüËÉΩÔºâ
    getLoveAdvice(situation) {
        const adviceBank = {
            'ÊöóÊàÄ': [
                'üíï ÊöóÊàÄÊòØÁæéÂ•ΩÁöÑÈñãÂßãÔºÅË©¶ËëóÂ§ö‰∫ÜËß£Â∞çÊñπÁöÑËààË∂£ÔºåÊâæÂÖ±ÂêåË©±È°åËá™ÁÑ∂Êé•Ëøë',
                'üåπ ÂãáÊï¢‰∏ÄÈªûÔºåÈÅ©ÊôÇË°®ÈÅîÈóúÂøÉÔºå‰ΩÜ‰∏çË¶ÅÂ§™ÈÅéÊøÄÈÄ≤ÔºåÁ¥∞Ê∞¥Èï∑ÊµÅÊúÄÂãï‰∫∫',
                'üíñ ÊèêÂçáËá™Â∑±ÁöÑÈ≠ÖÂäõÔºåËÆìËá™Â∑±ËÆäÂæóÊõ¥ÊúâË∂£ÔºåÂê∏ÂºïÂäõÊòØÁõ∏‰∫íÁöÑ'
            ],
            'ÂëäÁôΩ': [
                'üíå ÈÅ∏Êìá‰∏ÄÂÄãËàíÈÅ©ÁöÑÁí∞Â¢ÉÔºåÁúüË™†Âú∞Ë°®ÈÅî‰Ω†ÁöÑÊÑüÂèó',
                'üéÅ Ê∫ñÂÇô‰∏ÄÂÄãÂ∞èÈ©öÂñúÔºå‰ΩÜÈáçÈªûÊòØ‰Ω†ÁöÑÁúüÂøÉË©±',
                'üíï ‰∏çÁÆ°ÁµêÊûúÂ¶Ç‰ΩïÔºåÂãáÊï¢Ë°®ÈÅîÈÉΩÊòØÂÄºÂæóÈ©ïÂÇ≤ÁöÑ‰∫ã'
            ],
            'Á¥ÑÊúÉ': [
                'üçΩÔ∏è Á¨¨‰∏ÄÊ¨°Á¥ÑÊúÉÈÅ∏ÊìáËºïÈ¨ÜÁöÑÁí∞Â¢ÉÔºåÊØîÂ¶ÇÂíñÂï°Âª≥ÊàñÂÖ¨Âúí',
                'üëó Á©øÂæóÂæóÈ´î‰ΩÜË¶ÅËàíÈÅ©ÔºåÂ±ïÁèæÁúüÂØ¶ÁöÑËá™Â∑±',
                'üí¨ Â§öËÅΩÂ∞çÊñπË™™Ë©±ÔºåÂ±ïÁèæ‰Ω†ÁöÑÈóúÂøÉÂíåËààË∂£'
            ]
        };
        
        // ÈÄôË£°ÂèØ‰ª•Ê†πÊìöÊÉÖÊ≥ÅËøîÂõûÁõ∏ÊáâÂª∫Ë≠∞
        return adviceBank[situation] || ['üíñ ÊØèÂÄãÊÑõÊÉÖÊïÖ‰∫ãÈÉΩÊòØÁç®ÁâπÁöÑÔºåÂëäË®¥ÊàëÊõ¥Â§öÁ¥∞ÁØÄÔºåÊàëËÉΩÁµ¶‰Ω†Êõ¥Ê∫ñÁ¢∫ÁöÑÂª∫Ë≠∞ÔºÅ'];
    }
}

// ÂàùÂßãÂåñÊÑõÊÉÖÈ°ßÂïèËÅäÂ§©Ê©üÂô®‰∫∫
document.addEventListener('DOMContentLoaded', function() {
    // Á≠âÂæÖ‰∏ÄÁßíÁ¢∫‰øùÈ†ÅÈù¢ÂÆåÂÖ®ËºâÂÖ•
    setTimeout(() => {
        window.loveAdvisorChatBot = new LoveAdvisorChatBot();
        
        // Âú®ÊéßÂà∂Âè∞Êèê‰æõÊ∏ÖÈô§Ê≠∑Âè≤ÁöÑÊñπÊ≥ï
        window.clearLoveHistory = () => {
            if (confirm('üíî Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÊÑõÊÉÖÂ∞çË©±Ê≠∑Âè≤ÂóéÔºüÈÇ£‰∫õÁæéÂ•ΩÁöÑÂõûÊÜ∂Â∞±ÊúÉÊ∂àÂ§±‰∫ÜÂì¶ÔΩû')) {
                window.loveAdvisorChatBot.clearHistory();
            }
        };
        
        console.log('üíï ÊÑõÊÉÖÈ°ßÂïèËÅäÂ§©Ê©üÂô®‰∫∫ËºâÂÖ•ÂÆåÊàêÔºÅ');
        console.log('üíå Â¶ÇÈúÄÊ∏ÖÈô§ÊÑõÊÉÖÂ∞çË©±Ê≠∑Âè≤ÔºåË´ãÂú®ÊéßÂà∂Âè∞Âü∑Ë°åÔºöclearLoveHistory()');
        console.log('üåπ Ê∫ñÂÇôÂ•ΩÊé•ÂèóÊúÄË≤ºÂøÉÁöÑÊÑõÊÉÖÂª∫Ë≠∞‰∫ÜÂóéÔºü');
    }, 1000);
});